<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Version control system features - Trunk Based Development</title>
    <meta name="generator" content="Hugo 0.85.0" />

    
    <meta name="description" content="A portal on this practice">
    
    <link rel="canonical" href="index.html">
    
    <meta name="author" content="paul-hammant">
    

    <meta property="og:url" content="https://trunkbaseddevelopment.com/vcs-features/">
    <meta property="og:title" content="Trunk Based Development">
    <meta property="og:image" content="https://trunkbaseddevelopment.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Trunk Based Development">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('../fonts/icon.eot');
        src: url('../fonts/icon.eot')
               format('embedded-opentype'),
             url('../fonts/icon.woff')
               format('woff'),
             url('../fonts/icon.ttf')
               format('truetype'),
             url('../fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../stylesheets/application.css">
    <link rel="stylesheet" href="../stylesheets/temporary.css">
    <link rel="stylesheet" href="../stylesheets/palettes.css">
    <link rel="stylesheet" href="../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-light-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Trunk Based Development: Version control system features
      </div>
    </div>

    

        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <div class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../images/logo.png">
        </div>
      
      <div class="name">
        <strong>Trunk Based Development</strong>
      </div>
    </div>
  </div>

  <div class="scrollable">
    <div class="wrapper">
      <hr>

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Introduction" href="../index.html">
	
	Introduction
</a>



  
</li>



<li>
  
    



<a  title="Context" href="../context/index.html">
	
	Context
</a>



  
</li>



<li>
  
    



<a  title="Five-minute overview" href="../5-min-overview/index.html">
	
	Five-minute overview
</a>



  
</li>



<li>
  
    



<a  title="Deciding factors" href="../deciding-factors/index.html">
	
	Deciding factors
</a>



  
</li>



<li>
  
    



<a class="current" title="Version control system features" href="index.html">
	
	Version control system features
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Version control system choices" href="../vcs-choices/index.html">
	
	Version control system choices
</a>



  
</li>



<li>
  
    



<a  title="Feature flags" href="../feature-flags/index.html">
	
	Feature flags
</a>



  
</li>



<li>
  
    



<a  title="Branch by Abstraction" href="../branch-by-abstraction/index.html">
	
	Branch by Abstraction
</a>



  
</li>



<li>
  
    



<a  title="Branch for release" href="../branch-for-release/index.html">
	
	Branch for release
</a>



  
</li>



<li>
  
    



<a  title="Release from trunk" href="../release-from-trunk/index.html">
	
	Release from trunk
</a>



  
</li>



<li>
  
    



<a  title="Styles and Trade-offs" href="../styles/index.html">
	
	Styles and Trade-offs
</a>



  
</li>



<li>
  
    



<a  title="Continuous Integration (CI)" href="../continuous-integration/index.html">
	
	Continuous Integration (CI)
</a>



  
</li>



<li>
  
    



<a  title="Committing straight to the trunk" href="../committing-straight-to-the-trunk/index.html">
	
	Committing straight to the trunk
</a>



  
</li>



<li>
  
    



<a  title="Short Lived Feature Branches" href="../short-lived-feature-branches/index.html">
	
	Short Lived Feature Branches
</a>



  
</li>



<li>
  
    



<a  title="Continuous Code Review" href="../continuous-review/index.html">
	
	Continuous Code Review
</a>



  
</li>



<li>
  
    



<a  title="Continuous Delivery (CD)" href="../continuous-delivery/index.html">
	
	Continuous Delivery (CD)
</a>



  
</li>



<li>
  
    



<a  title="Concurrent development of consecutive releases" href="../concurrent-development-of-consecutive-releases/index.html">
	
	Concurrent development of consecutive releases
</a>



  
</li>



<li>
  
    



<a  title="Application strangulation" href="../strangulation/index.html">
	
	Application strangulation
</a>



  
</li>



<li>
  
    



<a  title="Observed habits" href="../observed-habits/index.html">
	
	Observed habits
</a>



  
</li>



<li>
  
    



<a  title="You&#39;re doing it wrong" href="../youre-doing-it-wrong/index.html">
	
	You&#39;re doing it wrong
</a>



  
</li>



<li>
  
    



<a  title="Alternative branching models" href="../alternative-branching-models/index.html">
	
	Alternative branching models
</a>



  
</li>



<li>
  
    



<a  title="Monorepos" href="../monorepos/index.html">
	
	Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Expanding Contracting Monorepos" href="../expanding-contracting-monorepos/index.html">
	
	Expanding Contracting Monorepos
</a>



  
</li>



<li>
  
    



<a  title="Game Changers" href="../game-changers/index.html">
	
	Game Changers
</a>



  
</li>



<li>
  
    



<a  title="Publications" href="../publications/index.html">
	
	Publications
</a>



  
</li>



<li>
  
    



<a  title="Book on this topic" href="../book/index.html">
	
	Book on this topic
</a>



  
</li>



<li>
  
    



<a  title="Key to branch diagrams" href="../key/index.html">
	
	Key to branch diagrams
</a>



  
</li>



<li>
  
    



<a  title="Contributions" href="../contributions/index.html">
	
	Contributions
</a>



  
</li>


        </ul>
        

        
        <hr>

        <ul>

          <li>
            <a href="https://github.com/paul-hammant/tbd" target="_blank" title="See GitHub Repo">
              Site Source on Github
            </a>
          </li>

          <li>
            <a href="https://github.com/paul-hammant/tbd/commit/7f6c170e3760e5ae5cb49fca37b73cfea475581d" target="_blank">
              SHA-1 Published: 7f6c170e3760e5ae5cb49fca37b73cfea475581d
            </a>
          </li>
          </li>
<iframe id="buy" width='160' height='400' src='https://leanpub.com/trunk-based-development/embed' frameborder='0' allowtransparency='true'></iframe>
          <li>
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1 style="color: white; padding: 32px 20px 72px; background-image:url(../images/LogoSlim.png); background-repeat: no-repeat; background-size: 100% auto"><span style="background-color: #5677fc">Version control system features </span></h1>

			<p><strong>Desirable VCS features, that is</strong></p>
<p>To great degree, Trunk-Based Development is possible on any Version Control System (VCS) that does atomic commits (spoiler: all do
that came after CVS).  Productivity and governance are what divides them, though.</p>
<h2 id="productivity">Productivity</h2>
<p>It turns out there are many
productivity related reasons that teams quit one technology and go to another. It does not matter whether the tool is a commercial
or an open source one. At least to its end users it does not.</p>
<p>By speed we mean two things primarily:</p>
<ol>
<li>The speed at which we can pull/update/sync changes out of a remote server repository</li>
<li>The speed at which we can commit/push changes back to that remote server</li>
</ol>
<p>And three other secondary things that support little and often:</p>
<ol>
<li>Advanced Merging</li>
<li>Code Review</li>
<li>Continuous Integration</li>
</ol>
<h3 id="pullupdatesync-speed">Pull/update/sync speed</h3>
<p>If you have at least once done a checkout of the source of the project, any subsequent pull/update/sync is going to bring down
differences from the previous checkout or update.  If you do two updates back to back quickly, the second one is likely to bring
down nothing.  The time taken for the version control tool to determine that nothing is due from the remote master
repository is the biggest clue as to how intrinsically fast it is.</p>
<p>Technologies that only keep head revision on the checkout, ordinarily have to walk the entire directory structure
looking for changed files and do handshaking to the server for each one. That is definitely Subversion and its predecessor CVS.
Batching of those exchanges speeds it up, but there is still a slowdown related to the breadth and depth of the source
tree. Perforce makes the operation faster because the server-side is poised for the sync operation at all times, by
keeping your tree and which revision you have for each file in RAM. It does this at the cost of maintaining read-only
bits for files (be sure and use an IDE that silently handles the Perforce interactions). Perforce can effectively be much
faster for this back-to-back pull/update/sync test of speed because it kinda already knows the answer to the question.</p>
<p>CVS, Subversion and Perforce offer you the choice of checking out a subdirectory. In a monorepo situation, you would
consider that a nice feature. At least if you&rsquo;ve recursively laid out services and applications within the trunk.</p>
<p>Git and Mercurial have a single point of checkout (Git&rsquo;s &lsquo;clone&rsquo; operation) for the whole repository.  There are no sub-directory checkouts
for these two. All commits since that
last &lsquo;pull&rsquo; will be pulled down. This happens before the directory walk to determine what has changed locally. As such, that
pull operation if very fast - there&rsquo;s no chit chat over the wire things, and the stuff on the server-side was already
zipped and pretty much ready for transfer. This will be the case even for situations where a particular
file has been changed a dozen times since you last pulled it down via a sync operation.  You might think
this is costly, but in practice, Git is incredibly fast.</p>
<h3 id="commitpush-speed">Commit/push speed</h3>
<p>Things are more equal here between the tools we highlight as viable.</p>
<p>Subversion and Perforce send up deltas of changed files to the server. Some directory walking can slow this down. There
is inevitably a lot of chit-chat on the wire for these operations.</p>
<p>Git and Mercurial do the same, but before you push to the remote repo it will make you commit locally which is incredibly
fast. Before you push to the shared remote repository, these two will make you pull first.</p>
<p>Perforce and Subversion will allow you to commit/push changes to the remote, without necessarily having the latest versions (and
incidentally all the intervening ones) locally first.  It will only allow that if there was no clash on the lines changed.</p>
<p>Perforce can cheat again, but taking advantage of the read-only bit, and therefore already knows which files definitely
have <strong>not</strong> changed between the remote master repo and local working copy. It still feels slower than it should be, though.</p>
<h3 id="three-way-merge-tools">Three-way merge tools</h3>
<p>Developers (hopefully in pairs) are going to have to become skilled in arbitrating over merges for the commits they
are trying to promote to the remote trunk, as well as the changes they are updating from that it in the case that they
have work in progress in their working-copy. Trunk-Based Development teams, you see, are merging more often. Albeit
those are smaller merges, and they are implicitly merged to your working copy.</p>
<p>Perforce&rsquo;s three-way merge tool (P4Merge) is good enough on its own to be attractive to teams using other VCS
technologies. For those other technologies, P4Merge  is just a config setting away from being usable.</p>
<p>Semantic merge is the next step up in the science of source-control. See <a href="../vcs-choices/index.html#plasticscm">Plastic SCM</a>.</p>
<h3 id="code-review">Code Review</h3>
<p>Integrated code review turned out to to be the killer feature of VCS tools. This should have been clear from the moment Mondrian
was unveiled by Guido van Rossum (Mr. Python) in a <a href="https://www.youtube.com/watch?v=sMql3Di4Kgc">publicized Google &lsquo;tech talk&rsquo; in 2006</a>. It delivered pre-commit
code reviews to developers and gamified the activity of code review to some degree. Google was
using Perforce back then (they changed to an in-house technology in 2012), and it did not have code review built in, so
they had to make Mondrian (which was the final form of years of intermediate deliverables for the same). Thus
Mondrian being created tightly coupled code review to the hourly activities of developers on the trunk.</p>
<p>GitHub (not Git) was next for the non-Google dev world with a built in code-review tool (and workflow). Again this was
effectively pre-commit - or at least commit to the master.</p>
<p>There were (and are) other technologies for code review such as Crucible (Atlassian), UpSource (JetBrains), Gerrit,
Phabricator, but integration into a platform experience is key.  GitLab and RhodeCode are emerging platforms.</p>
<p>Read more in <a href="../game-changers/index.html#google-s-internal-devops-2006-onwards">Game Changers - Google&rsquo;s Mondrian</a> and
<a href="../game-changers/index.html#github-s-entire-platform-2008-onwards">Game Changers - GitHub&rsquo;s Pull Requests</a>.</p>
<h3 id="continuous-integration-testing">Continuous Integration testing</h3>
<p>This goes hand in hand with the Code Review capability. CI Servers kick in for commits are pushed up code review branches,
or at least against change sets that are entering code review and validate them. The regular build, and maybe some
additional steps are executed against them and the results of those made available to code reviewers, Facebook has a
Service Level Agreement to have those complete ten minutes after the commit has been placed in the &lsquo;needs code review&rsquo;
queue.</p>
<p>The reality of VCS platforms today is that they only provided hooks (web-hooks most likely) into other CI servers. The
best combinations of VCS platform and CI server do so for any of the branches in play, including code-review branches
(forks).</p>
<h2 id="governance">Governance</h2>
<p>It turns out that enterprises like the ability to carve up permissions, and set read and write permissions throughout
their repositories.</p>
<h3 id="fine-grained-permissions">fine grained permissions</h3>
<p>All VCS usages need users accounts to be able to accept changes back, even if they don&rsquo;t all require accounts in order
to be able to read. In the enterprise user accounts will be required to be able to read too.</p>
<p>The larger the enterprise the more likely it will be that they have permissions carved up in more fine grained ways.
For example &ldquo;can commit to the trunk, but cannot create release branches&rdquo; will be common for Trunk-Based Development
teams that make release branches.  Not all VCS technologies support that. Git, for example, does not, but some of the
portal experiences around it, add the feature. In reality, though, you cannot stop people from making branches in a DVCS,
but you can prevent them from pushing them to the shared repository.</p>
<p>Deeper still, some enterprises will want to set permissions down the directory level within a branch within a repository.
This could be as simple as a gate, to ensure that process is adhered to around checkins, but could also be to guard
some secrets in a Monorepo implementation. That last is counter to some of the &ldquo;common code ownership&rdquo; ideals of
modern software engineering though.</p>
<h3 id="size--scale">Size / Scale</h3>
<p>Many teams, particularly those with Monorepo configurations or large binary files (like Games companies), want to have
limitless server-side storage for their repository.  Git and Mercurial are inching towards bigger and bigger
capacity, but there are still a few snafus to work through - how to cleanly/safely reduce the size of the client side clone
history (while still being able to push changes back to the server) is a challenge.</p>
<p>Microsoft released Git Virtual File System (<del>GitVFS</del> <del>GVFS</del> VFS for Git<span class="rref"><a class="inline-ref" style="border-bottom: 0" target="_blank" href="https://vfsforgit.org/"><img style="padding: 0 0 0 3px; width: 16px; height: 14px" src="../images/ext.png" alt=""></a></span>) in early 2017, to layer on some of the things they had
become used to in the in-house recompilation of Perforce (SourceDepot - used from 1998 to 201x), as well as native VCS
of their commercial offering Team Foundation Server (TFS).</p>


			<aside class="copyright" role="note">
				&copy; 2017-2020: <a href="https://devops.paulhammant.com/">Paul Hammant</a>. With Contributions <a href="../contributions/index.html">from friends</a>.
				Site built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				with
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme,
				via <a href="https://netlify.com/">Netlify</a>. &nbsp;
				<a href="https://github.com/paul-hammant/tbd/edit/master/content//_index.md">Contribute to this page</a>

			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="../vcs-choices/index.html" title="Version control system choices">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Version control system choices
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="../deciding-factors/index.html" title="Deciding factors">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Deciding factors
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/trunkbaseddevelopment.com\/';
      var repo_id  = 'paul-hammant\/tbd';
    
    </script>

    <script src="../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }

      var showHideRefs = document.getElementById("showHideRefs");
      var refsElsewhereH1;
      var refsTable;
      if (showHideRefs) {
          refsElsewhereH1 = document.getElementById("references-elsewhere");
      }
      if (showHideRefs) {
          refsTable = refsElsewhereH1.nextElementSibling.nextElementSibling;
          hideRefs();
      }

      function hideRefs() {
          refsTable.style.display = "none";
          showHideRefs.innerHTML = "show references";
      }

      function toggleRefs() {
          if(refsTable.style.display == "block") {
              hideRefs();
          }
          else {
              refsTable.style.display = "block";
              showHideRefs.innerHTML = "hide references";
          }
      }


    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-24415524-3', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

